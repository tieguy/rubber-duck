# Fly.io configuration for Rubber Duck
# See https://fly.io/docs/reference/configuration/

app = "rubber-duck"
primary_region = "lax"

[env]
  TZ = "America/Los_Angeles"

[build]
  dockerfile = "Dockerfile"

# No HTTP service - this is a Discord bot, not a web server
# The bot connects outbound to Discord, no inbound ports needed

[[vm]]
  size = "shared-cpu-1x"
  memory = "256mb"

# Only run one instance (Discord bot can't have multiple)
[deploy]
  strategy = "immediate"

# Keep the bot running (no auto-stop since there's no HTTP service)
[processes]
  app = "./entrypoint.sh"

# Restart policy - always restart on failure
[[restart]]
  policy = "always"
  retries = 5

# Persistent storage for state (journal, insights, etc.)
[[mounts]]
  source = "rubber_duck_state"
  destination = "/app/state"
